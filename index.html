<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hebrew Reading Adventure üåü</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --blue: #1a3a6b;
    --gold: #f0c040;
    --lightblue: #4a7ec7;
    --sky: #e8f0ff;
    --green: #2ecc71;
    --red: #e74c3c;
    --white: #fff;
    --shadow: 0 4px 18px rgba(26,58,107,0.13);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Nunito', sans-serif;
    background: linear-gradient(135deg, #1a3a6b 0%, #2563c7 60%, #4a7ec7 100%);
    min-height: 100vh;
    color: #1a3a6b;
  }

  header {
    text-align: center;
    padding: 30px 20px 10px;
    color: white;
  }

  header h1 {
    font-family: 'Fredoka One', cursive;
    font-size: 2.6em;
    letter-spacing: 1px;
    text-shadow: 0 3px 12px rgba(0,0,0,0.25);
    margin-bottom: 6px;
  }

  header .subtitle {
    font-size: 1.1em;
    opacity: 0.85;
    font-weight: 600;
  }

  .stars {
    font-size: 1.6em;
    letter-spacing: 4px;
    margin: 6px 0;
  }

  .tabs {
    display: flex;
    justify-content: center;
    gap: 10px;
    padding: 18px 20px 0;
    flex-wrap: wrap;
  }

  .tab-btn {
    background: rgba(255,255,255,0.18);
    color: white;
    border: 2px solid rgba(255,255,255,0.4);
    border-radius: 30px;
    padding: 9px 22px;
    font-family: 'Nunito', sans-serif;
    font-weight: 700;
    font-size: 1em;
    cursor: pointer;
    transition: all 0.2s;
  }

  .tab-btn:hover, .tab-btn.active {
    background: var(--gold);
    color: var(--blue);
    border-color: var(--gold);
    transform: translateY(-2px);
    box-shadow: 0 4px 14px rgba(240,192,64,0.4);
  }

  .container {
    max-width: 860px;
    margin: 22px auto 40px;
    padding: 0 16px;
  }

  .card {
    background: white;
    border-radius: 24px;
    padding: 30px;
    box-shadow: var(--shadow);
    margin-bottom: 20px;
  }

  .section-title {
    font-family: 'Fredoka One', cursive;
    font-size: 1.5em;
    color: var(--blue);
    margin-bottom: 18px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  /* ===== SYLLABLE BREAKDOWN ===== */
  .word-selector {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 24px;
  }

  .word-btn {
    background: var(--sky);
    border: 2px solid var(--lightblue);
    border-radius: 16px;
    padding: 8px 18px;
    font-family: 'Nunito', sans-serif;
    font-weight: 700;
    font-size: 1em;
    color: var(--blue);
    cursor: pointer;
    transition: all 0.2s;
  }

  .word-btn:hover, .word-btn.active {
    background: var(--blue);
    color: white;
    border-color: var(--blue);
    transform: translateY(-2px);
  }

  .hebrew-display {
    text-align: center;
    padding: 24px 10px;
    background: linear-gradient(135deg, #f0f6ff, #e8f0ff);
    border-radius: 20px;
    margin-bottom: 20px;
    border: 2px solid #c5d8ff;
  }

  .hebrew-full {
    font-size: 4em;
    direction: rtl;
    font-weight: 800;
    color: var(--blue);
    letter-spacing: 4px;
    line-height: 1.2;
    margin-bottom: 6px;
    text-shadow: 0 2px 8px rgba(26,58,107,0.1);
  }

  .english-meaning {
    font-size: 1.1em;
    color: #666;
    font-weight: 600;
    margin-top: 4px;
  }

  .syllable-row {
    display: flex;
    justify-content: center;
    gap: 14px;
    flex-wrap: wrap;
    margin: 20px 0;
    direction: rtl;
  }

  .syllable-block {
    background: white;
    border: 3px solid var(--lightblue);
    border-radius: 18px;
    padding: 16px 22px;
    text-align: center;
    cursor: pointer;
    transition: all 0.25s;
    box-shadow: 0 3px 10px rgba(74,126,199,0.15);
    min-width: 100px;
  }

  .syllable-block:hover {
    transform: translateY(-4px) scale(1.04);
    border-color: var(--blue);
    box-shadow: 0 8px 24px rgba(26,58,107,0.18);
  }

  .syllable-block.highlight {
    background: var(--gold);
    border-color: #d4a010;
    transform: translateY(-4px) scale(1.06);
    animation: bounce 0.4s ease;
  }

  @keyframes bounce {
    0%,100% { transform: translateY(-4px) scale(1.06); }
    50% { transform: translateY(-8px) scale(1.08); }
  }

  .syl-hebrew {
    font-size: 2.2em;
    direction: rtl;
    font-weight: 800;
    color: var(--blue);
    display: block;
    margin-bottom: 6px;
  }

  .syllable-block.highlight .syl-hebrew { color: var(--blue); }

  .syl-sound {
    font-size: 1em;
    font-weight: 800;
    color: var(--lightblue);
    background: var(--sky);
    padding: 3px 10px;
    border-radius: 20px;
    display: inline-block;
  }

  .syllable-block.highlight .syl-sound {
    background: rgba(255,255,255,0.6);
    color: var(--blue);
  }

  .play-all-btn {
    display: block;
    margin: 18px auto 0;
    background: var(--blue);
    color: white;
    border: none;
    border-radius: 30px;
    padding: 12px 36px;
    font-family: 'Fredoka One', cursive;
    font-size: 1.2em;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 14px rgba(26,58,107,0.25);
  }

  .play-all-btn:hover {
    background: var(--lightblue);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(26,58,107,0.3);
  }

  .pronounce-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    border: none;
    border-radius: 30px;
    padding: 10px 24px;
    font-family: 'Fredoka One', cursive;
    font-size: 1.1em;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 14px rgba(46,204,113,0.35);
    margin: 10px auto 0;
    display: block;
  }
  .pronounce-btn:hover {
    transform: translateY(-2px) scale(1.04);
    box-shadow: 0 8px 20px rgba(46,204,113,0.45);
  }
  .pronounce-btn.speaking {
    background: linear-gradient(135deg, #f0c040, #e6a800);
    box-shadow: 0 4px 14px rgba(240,192,64,0.45);
    animation: pulse 0.6s ease infinite alternate;
  }
  @keyframes pulse {
    from { transform: scale(1); }
    to { transform: scale(1.05); }
  }
  .tts-note {
    text-align: center;
    font-size: 0.8em;
    color: #999;
    margin-top: 6px;
  }

  .tip-box {
    background: linear-gradient(135deg, #fffbe6, #fff8cc);
    border: 2px solid var(--gold);
    border-radius: 16px;
    padding: 14px 18px;
    margin-top: 16px;
    font-size: 0.97em;
    color: #7a5700;
    font-weight: 600;
  }

  /* ===== ALPHABET SECTION ===== */
  .aleph-bet-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 12px;
  }

  .letter-card {
    background: var(--sky);
    border: 2px solid #c5d8ff;
    border-radius: 16px;
    padding: 14px 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
  }

  .letter-card:hover {
    background: var(--blue);
    border-color: var(--blue);
    transform: translateY(-3px);
    box-shadow: var(--shadow);
  }

  .letter-card:hover .lc-heb { color: var(--gold); }
  .letter-card:hover .lc-name, .letter-card:hover .lc-sound { color: white; }

  .lc-heb {
    font-size: 2em;
    font-weight: 800;
    color: var(--blue);
    display: block;
  }

  .lc-name {
    font-size: 0.72em;
    font-weight: 700;
    color: var(--blue);
    display: block;
    margin-top: 3px;
  }

  .lc-sound {
    font-size: 0.7em;
    color: var(--lightblue);
    display: block;
    font-weight: 600;
  }

  /* ===== VOWELS SECTION ===== */
  .vowel-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 14px;
  }

  .vowel-card {
    background: var(--sky);
    border: 2px solid #c5d8ff;
    border-radius: 16px;
    padding: 16px 10px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
  }

  .vowel-card:hover {
    background: linear-gradient(135deg, #1a3a6b, #4a7ec7);
    transform: translateY(-3px);
    box-shadow: var(--shadow);
    border-color: var(--blue);
  }

  .vowel-card:hover .vc-heb { color: var(--gold); }
  .vowel-card:hover .vc-name, .vowel-card:hover .vc-sound { color: white; }

  .vc-heb {
    font-size: 2.4em;
    font-weight: 800;
    color: var(--blue);
    display: block;
    direction: rtl;
  }

  .vc-name {
    font-size: 0.8em;
    font-weight: 700;
    color: var(--blue);
    display: block;
    margin-top: 5px;
  }

  .vc-sound {
    font-size: 0.8em;
    color: var(--lightblue);
    display: block;
    font-weight: 700;
    background: white;
    border-radius: 12px;
    padding: 2px 8px;
    margin-top: 4px;
    display: inline-block;
  }

  .vowel-card:hover .vc-sound {
    background: rgba(255,255,255,0.2);
    color: white;
  }

  /* ===== QUIZ SECTION ===== */
  .quiz-word {
    text-align: center;
    font-size: 5em;
    direction: rtl;
    font-weight: 800;
    color: var(--blue);
    padding: 20px;
    background: var(--sky);
    border-radius: 20px;
    margin-bottom: 22px;
    letter-spacing: 6px;
  }

  .quiz-question {
    text-align: center;
    font-size: 1.2em;
    font-weight: 700;
    color: var(--blue);
    margin-bottom: 18px;
  }

  .quiz-choices {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    max-width: 480px;
    margin: 0 auto;
  }

  .choice-btn {
    background: white;
    border: 3px solid var(--lightblue);
    border-radius: 16px;
    padding: 14px 12px;
    font-family: 'Nunito', sans-serif;
    font-weight: 800;
    font-size: 1.05em;
    color: var(--blue);
    cursor: pointer;
    transition: all 0.2s;
  }

  .choice-btn:hover { background: var(--sky); transform: translateY(-2px); }
  .choice-btn.correct { background: #d4fce8; border-color: var(--green); color: #1a6b40; }
  .choice-btn.wrong { background: #ffe0de; border-color: var(--red); color: var(--red); }

  .quiz-feedback {
    text-align: center;
    font-size: 1.3em;
    font-weight: 800;
    margin-top: 18px;
    min-height: 40px;
    transition: all 0.3s;
  }

  .quiz-feedback.correct { color: var(--green); }
  .quiz-feedback.wrong { color: var(--red); }

  .score-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--sky);
    border-radius: 16px;
    padding: 12px 20px;
    margin-bottom: 20px;
    font-weight: 700;
    color: var(--blue);
  }

  .score-stars { font-size: 1.4em; }

  .next-btn {
    display: block;
    margin: 16px auto 0;
    background: var(--green);
    color: white;
    border: none;
    border-radius: 30px;
    padding: 12px 36px;
    font-family: 'Fredoka One', cursive;
    font-size: 1.2em;
    cursor: pointer;
    transition: all 0.2s;
    opacity: 0;
    pointer-events: none;
  }

  .next-btn.visible {
    opacity: 1;
    pointer-events: all;
    animation: popIn 0.3s ease;
  }

  @keyframes popIn {
    0% { transform: scale(0.7); }
    80% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }

  .hidden { display: none !important; }

  /* ===== PRAYERS SECTION ===== */
  .prayer-list { display: flex; flex-direction: column; gap: 14px; }

  .prayer-card {
    background: var(--sky);
    border: 2px solid #c5d8ff;
    border-radius: 18px;
    padding: 18px 22px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .prayer-card:hover {
    border-color: var(--blue);
    box-shadow: var(--shadow);
    transform: translateX(4px);
  }

  .prayer-card.open {
    border-color: var(--gold);
    background: #fffbe6;
  }

  .prayer-name {
    font-family: 'Fredoka One', cursive;
    font-size: 1.2em;
    color: var(--blue);
    margin-bottom: 2px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .prayer-hebrew-name {
    font-size: 1.4em;
    direction: rtl;
    font-weight: 800;
    color: var(--lightblue);
  }

  .prayer-body {
    margin-top: 14px;
    padding-top: 14px;
    border-top: 2px dashed #c5d8ff;
  }

  .prayer-text-heb {
    font-size: 1.9em;
    direction: rtl;
    text-align: right;
    font-weight: 800;
    color: var(--blue);
    line-height: 1.8;
    margin-bottom: 10px;
  }

  .prayer-text-eng {
    font-size: 0.95em;
    color: #555;
    font-weight: 600;
    line-height: 1.6;
    font-style: italic;
  }

  .prayer-syllables {
    margin-top: 14px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    direction: rtl;
  }

  .chunk {
    background: white;
    border: 2px solid var(--lightblue);
    border-radius: 12px;
    padding: 8px 14px;
    text-align: center;
    direction: rtl;
    transition: all 0.2s;
  }

  .chunk-heb { font-size: 1.4em; font-weight: 800; color: var(--blue); display: block; }
  .chunk-sound { font-size: 0.75em; font-weight: 700; color: var(--lightblue); display: block; margin-top: 2px; }

  .chunk-active {
    background: var(--gold) !important;
    border-color: #d4a010 !important;
    transform: translateY(-3px) scale(1.08);
    box-shadow: 0 6px 18px rgba(240,192,64,0.4);
  }

  .chunk-active .chunk-heb { color: var(--blue); }

  footer {
    text-align: center;
    padding: 18px;
    color: rgba(255,255,255,0.6);
    font-size: 0.9em;
    font-weight: 600;
  }
</style>
</head>
<body>

<header>
  <div class="stars">‚ú°Ô∏è ‚≠ê ‚ú°Ô∏è</div>
  <h1>Hebrew Reading Adventure</h1>
  <p class="subtitle">Learn to read Hebrew ‚Äî one syllable at a time! üéâ</p>
</header>

<div class="tabs">
  <button class="tab-btn active" onclick="showTab('words',this)">üìñ Word Breakdown</button>
  <button class="tab-btn" onclick="showTab('alphabet',this)">üî§ Aleph-Bet</button>
  <button class="tab-btn" onclick="showTab('vowels',this)">üéµ Vowels (Nikkud)</button>
  <button class="tab-btn" onclick="showTab('prayers',this)">üïç Prayers</button>
  <button class="tab-btn" onclick="showTab('quiz',this)">üß† Quiz!</button>
</div>

<div class="container">

  <!-- WORD BREAKDOWN TAB -->
  <div id="tab-words" class="card">
    <div class="section-title">üìñ Click a word, then tap the syllables!</div>
    <div class="word-selector" id="wordSelector"></div>
    <div class="hebrew-display">
      <div class="hebrew-full" id="hebrewFull">◊©÷∏◊Å◊ú◊ï÷π◊ù</div>
      <div id="hebrewPronounce" style="font-size:1.3em;font-weight:800;color:#4a7ec7;margin-top:4px;"></div>
      <div class="english-meaning" id="englishMeaning">Peace / Hello / Goodbye</div>
    </div>
    <div class="syllable-row" id="syllableRow"></div>
    <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:18px;">
      <button class="play-all-btn" style="margin:0;" onclick="playAllSyllables()">‚ñ∂ Animate syllables: <span id="playAllText"></span></button>
      <button class="pronounce-btn" id="pronounceBtn" onclick="pronounceWord()">üîä Hear it spoken</button>
    </div>
    <div class="tts-note" id="ttsNote"></div>
    <div class="tip-box" id="tipBox" style="margin-top:16px;">üí° Tip: Hebrew is read <strong>right to left</strong>! The first syllable is on the right.</div>
  </div>

  <!-- ALPHABET TAB -->
  <div id="tab-alphabet" class="card hidden">
    <div class="section-title">üî§ The Aleph-Bet (Hebrew Alphabet)</div>
    <p style="margin-bottom:18px;color:#555;font-weight:600;">Click any letter to highlight it! Hebrew has 22 letters, all consonants.</p>
    <div class="aleph-bet-grid" id="alephBetGrid"></div>
    <div class="tip-box" style="margin-top:18px;">üí° Letters with a dot (dagesh) in the middle have a slightly harder sound. Some letters have a different shape at the END of a word ‚Äî called a <strong>sofit</strong> form!</div>
  </div>

  <!-- VOWELS TAB -->
  <div id="tab-vowels" class="card hidden">
    <div class="section-title">üéµ Vowel Signs (Nikkud)</div>
    <p style="margin-bottom:18px;color:#555;font-weight:600;">In prayer books, little dots and dashes under/over letters tell you what vowel sound to make. Hover to see!</p>
    <div class="vowel-grid" id="vowelGrid"></div>
    <div class="tip-box" style="margin-top:18px;">üí° The vowel sound comes AFTER the consonant. So ◊ë÷∏÷º (Bet + Kamatz) = "BAH"!</div>
  </div>

  <!-- PRAYERS TAB -->
  <div id="tab-prayers" class="card hidden">
    <div class="section-title">üïç Common Prayers & Blessings</div>
    <p style="margin-bottom:18px;color:#555;font-weight:600;">Click any prayer to see it broken into chunks you can practice!</p>
    <div class="prayer-list" id="prayerList"></div>
  </div>

  <!-- QUIZ TAB -->
  <div id="tab-quiz" class="card hidden">
    <div class="section-title">üß† Reading Quiz!</div>
    <div class="score-bar">
      <span>Score: <strong id="scoreDisplay">0</strong></span>
      <span class="score-stars" id="scoreStars">‚≠ê</span>
      <span>Question <strong id="qNum">1</strong> / 10</span>
    </div>
    <div class="quiz-word" id="quizWord"></div>
    <div class="quiz-question">How do you say this word?</div>
    <div class="quiz-choices" id="quizChoices"></div>
    <div class="quiz-feedback" id="quizFeedback"></div>
    <button class="next-btn" id="nextBtn" onclick="nextQuestion()">Next ‚û°Ô∏è</button>
  </div>

</div>

<footer>Built with ‚ù§Ô∏è for Bar Mitzvah preparation ¬∑ Hebrew is a beautiful language!</footer>

<script>
// ===== DATA =====

const words = [
  {
    hebrew: "◊©÷∏◊Å◊ú◊ï÷π◊ù",
    english: "Peace / Hello / Goodbye",
    pronounce: "Sha¬∑LOM",
    syllables: [
      { heb: "◊©÷∏◊Å", sound: "SHA" },
      { heb: "◊ú◊ï÷π◊ù", sound: "LOM" }
    ],
    tip: "üí° 'Shalom' is one of the most important words in Hebrew ‚Äî it means peace, hello, AND goodbye!"
  },
  {
    hebrew: "◊ë÷∞÷º◊®÷∏◊õ÷∏◊î",
    english: "Blessing",
    pronounce: "B'¬∑ra¬∑KHAH",
    syllables: [
      { heb: "◊ë÷∞÷º", sound: "B'" },
      { heb: "◊®÷∏", sound: "RA" },
      { heb: "◊õ÷∏◊î", sound: "KHAH" }
    ],
    tip: "üí° A 'bracha' is a blessing you say before doing a mitzvah or eating."
  },
  {
    hebrew: "◊™÷º◊ï÷π◊®÷∏◊î",
    english: "The Torah",
    pronounce: "To¬∑RAH",
    syllables: [
      { heb: "◊™÷º◊ï÷π", sound: "TO" },
      { heb: "◊®÷∏◊î", sound: "RAH" }
    ],
    tip: "üí° The Torah is the first 5 books of the Bible ‚Äî the most sacred Jewish text!"
  },
  {
    hebrew: "◊©÷∑◊Å◊ë÷∏÷º◊™",
    english: "Sabbath / Saturday",
    pronounce: "Sha¬∑BAT",
    syllables: [
      { heb: "◊©÷∑◊Å", sound: "SHA" },
      { heb: "◊ë÷∏÷º◊™", sound: "BAT" }
    ],
    tip: "üí° Shabbat starts Friday at sunset and ends Saturday night. It's a day of rest!"
  },
  {
    hebrew: "◊û÷¥◊¶÷∞◊ï÷∏◊î",
    english: "Commandment / Good deed",
    pronounce: "mitz¬∑VAH",
    syllables: [
      { heb: "◊û÷¥", sound: "MI" },
      { heb: "◊¶÷∞", sound: "TZ'" },
      { heb: "◊ï÷∏◊î", sound: "VAH" }
    ],
    tip: "üí° There are 613 mitzvot (commandments) in the Torah. Bar Mitzvah means 'son of the commandment'!"
  },
  {
    hebrew: "◊ê÷∏◊û÷µ◊ü",
    english: "Amen (So be it)",
    pronounce: "a¬∑MEN",
    syllables: [
      { heb: "◊ê÷∏", sound: "AH" },
      { heb: "◊û÷µ◊ü", sound: "MEN" }
    ],
    tip: "üí° You say 'Amen' after a prayer or blessing to agree with it and make it yours too."
  },
  {
    hebrew: "◊ô÷¥◊©÷∞◊Ç◊®÷∏◊ê÷µ◊ú",
    english: "Israel",
    pronounce: "yis¬∑ra¬∑EL",
    syllables: [
      { heb: "◊ô÷¥", sound: "YI" },
      { heb: "◊©÷∞◊Ç", sound: "S'" },
      { heb: "◊®÷∏", sound: "RA" },
      { heb: "◊ê÷µ◊ú", sound: "EL" }
    ],
    tip: "üí° Yisrael means 'one who wrestles with God.' It became the name of the Jewish people!"
  },
  {
    hebrew: "◊ê÷±◊ú÷π◊î÷¥◊ô◊ù",
    english: "God (plural of majesty)",
    pronounce: "e¬∑lo¬∑HIM",
    syllables: [
      { heb: "◊ê÷±", sound: "E" },
      { heb: "◊ú÷π", sound: "LO" },
      { heb: "◊î÷¥◊ô◊ù", sound: "HIM" }
    ],
    tip: "üí° Elohim is a name for God used in the Torah. Even though it looks plural, it refers to the one God."
  },
  {
    hebrew: "◊ó÷∑◊ô÷¥÷º◊ô◊ù",
    english: "Life / L'Chaim!",
    pronounce: "cha¬∑YIM",
    syllables: [
      { heb: "◊ó÷∑", sound: "CHA" },
      { heb: "◊ô÷¥÷º◊ô◊ù", sound: "YIM" }
    ],
    tip: "üí° 'L'Chaim' means 'To life!' ‚Äî the classic Jewish toast at celebrations!"
  },
  {
    hebrew: "◊ß÷∞◊ì◊ï÷º◊©÷∏◊Å◊î",
    english: "Holiness / Kedushah",
    pronounce: "k'¬∑du¬∑SHAH",
    syllables: [
      { heb: "◊ß÷∞", sound: "K'" },
      { heb: "◊ì◊ï÷º", sound: "DU" },
      { heb: "◊©÷∏◊Å◊î", sound: "SHAH" }
    ],
    tip: "üí° Kedushah means holiness ‚Äî it's also the name of an important prayer in the Amidah!"
  }
];

const alphabet = [
  { heb: "◊ê", name: "Aleph", sound: "silent" },
  { heb: "◊ë÷º", name: "Bet", sound: "B" },
  { heb: "◊ë", name: "Vet", sound: "V" },
  { heb: "◊í", name: "Gimel", sound: "G" },
  { heb: "◊ì", name: "Dalet", sound: "D" },
  { heb: "◊î", name: "Heh", sound: "H" },
  { heb: "◊ï", name: "Vav", sound: "V/OO/O" },
  { heb: "◊ñ", name: "Zayin", sound: "Z" },
  { heb: "◊ó", name: "Chet", sound: "CH" },
  { heb: "◊ò", name: "Tet", sound: "T" },
  { heb: "◊ô", name: "Yod", sound: "Y/EE" },
  { heb: "◊õ÷º", name: "Kaf", sound: "K" },
  { heb: "◊õ", name: "Khaf", sound: "KH" },
  { heb: "◊ú", name: "Lamed", sound: "L" },
  { heb: "◊û", name: "Mem", sound: "M" },
  { heb: "◊†", name: "Nun", sound: "N" },
  { heb: "◊°", name: "Samech", sound: "S" },
  { heb: "◊¢", name: "Ayin", sound: "silent" },
  { heb: "◊§÷º", name: "Peh", sound: "P" },
  { heb: "◊§", name: "Feh", sound: "F" },
  { heb: "◊¶", name: "Tsadi", sound: "TZ" },
  { heb: "◊ß", name: "Kuf", sound: "K" },
  { heb: "◊®", name: "Resh", sound: "R" },
  { heb: "◊©◊Å", name: "Shin", sound: "SH" },
  { heb: "◊©◊Ç", name: "Sin", sound: "S" },
  { heb: "◊™", name: "Tav", sound: "T" }
];

const vowels = [
  { heb: "◊ë÷∏", name: "Kamatz", sound: "AH" },
  { heb: "◊ë÷∑", name: "Patach", sound: "AH" },
  { heb: "◊ë÷µ", name: "Tzere", sound: "AY" },
  { heb: "◊ë÷∂", name: "Segol", sound: "EH" },
  { heb: "◊ë÷¥", name: "Chirik", sound: "EE" },
  { heb: "◊ë÷π", name: "Cholam", sound: "OH" },
  { heb: "◊ë◊ï÷π", name: "Cholam Male", sound: "OH" },
  { heb: "◊ë◊ï÷º", name: "Shuruk", sound: "OO" },
  { heb: "◊ë÷ª", name: "Kubutz", sound: "OO" },
  { heb: "◊ë÷∞", name: "Shva", sound: "short E" },
  { heb: "◊ë÷±", name: "Chataf Segol", sound: "EH" },
  { heb: "◊ë÷≤", name: "Chataf Patach", sound: "AH" },
  { heb: "◊ë÷≥", name: "Chataf Kamatz", sound: "OH" }
];

const prayers = [
  {
    name: "Shema",
    hebrewName: "◊©÷∞◊Å◊û÷∑◊¢",
    text: "◊©÷∞◊Å◊û÷∑◊¢ ◊ô÷¥◊©÷∞◊Ç◊®÷∏◊ê÷µ◊ú ◊ô÷∞◊î◊ï÷∏◊î ◊ê÷±◊ú÷π◊î÷µ◊ô◊†◊ï÷º ◊ô÷∞◊î◊ï÷∏◊î ◊ê÷∂◊ó÷∏◊ì",
    translation: "Hear O Israel, the Lord is our God, the Lord is One.",
    chunks: [
      { heb: "◊©÷∞◊Å◊û÷∑◊¢", sound: "sh'MA" },
      { heb: "◊ô÷¥◊©÷∞◊Ç◊®÷∏◊ê÷µ◊ú", sound: "yis-ra-EL" },
      { heb: "◊ô÷∞◊î◊ï÷∏◊î", sound: "Ado-NAI" },
      { heb: "◊ê÷±◊ú÷π◊î÷µ◊ô◊†◊ï÷º", sound: "e-lo-HEI-nu" },
      { heb: "◊ô÷∞◊î◊ï÷∏◊î", sound: "Ado-NAI" },
      { heb: "◊ê÷∂◊ó÷∏◊ì", sound: "e-CHAD" }
    ]
  },
  {
    name: "Barchu",
    hebrewName: "◊ë÷∏÷º◊®÷∞◊õ◊ï÷º",
    text: "◊ë÷∏÷º◊®÷∞◊õ◊ï÷º ◊ê÷∂◊™ ◊ô÷∞◊î◊ï÷∏◊î ◊î÷∑◊û÷∞◊ë÷π◊®÷∏◊ö÷∞",
    translation: "Bless the Lord who is blessed.",
    chunks: [
      { heb: "◊ë÷∏÷º◊®÷∞◊õ◊ï÷º", sound: "bar-KHU" },
      { heb: "◊ê÷∂◊™", sound: "et" },
      { heb: "◊ô÷∞◊î◊ï÷∏◊î", sound: "Ado-NAI" },
      { heb: "◊î÷∑◊û÷∞◊ë÷π◊®÷∏◊ö÷∞", sound: "ha-m'vo-RAKH" }
    ]
  },
  {
    name: "Modeh Ani",
    hebrewName: "◊û◊ï÷π◊ì÷∂◊î ◊ê÷≤◊†÷¥◊ô",
    text: "◊û◊ï÷π◊ì÷∂◊î ◊ê÷≤◊†÷¥◊ô ◊ú÷∞◊§÷∏◊†÷∂◊ô◊ö÷∏ ◊û÷∂◊ú÷∂◊ö÷∞ ◊ó÷∑◊ô ◊ï÷∞◊ß÷∑◊ô÷∏÷º◊ù",
    translation: "I give thanks before You, living and eternal King.",
    chunks: [
      { heb: "◊û◊ï÷π◊ì÷∂◊î", sound: "MO-deh" },
      { heb: "◊ê÷≤◊†÷¥◊ô", sound: "a-NI" },
      { heb: "◊ú÷∞◊§÷∏◊†÷∂◊ô◊ö÷∏", sound: "l'fa-NE-kha" },
      { heb: "◊û÷∂◊ú÷∂◊ö÷∞", sound: "ME-lekh" },
      { heb: "◊ó÷∑◊ô", sound: "CHAI" },
      { heb: "◊ï÷∞◊ß÷∑◊ô÷∏÷º◊ù", sound: "v'ka-YAM" }
    ]
  },
  {
    name: "Kiddush Opening",
    hebrewName: "◊ß÷¥◊ì÷º◊ï÷º◊©◊Å",
    text: "◊ë÷∏÷º◊®◊ï÷º◊ö÷∞ ◊ê÷∑◊™÷∏÷º◊î ◊ô÷∞◊î◊ï÷∏◊î ◊ê÷±◊ú÷π◊î÷µ◊ô◊†◊ï÷º ◊û÷∂◊ú÷∂◊ö÷∞ ◊î÷∏◊¢◊ï÷π◊ú÷∏◊ù",
    translation: "Blessed are You, Lord our God, King of the universe.",
    chunks: [
      { heb: "◊ë÷∏÷º◊®◊ï÷º◊ö÷∞", sound: "ba-RUKH" },
      { heb: "◊ê÷∑◊™÷∏÷º◊î", sound: "a-TAH" },
      { heb: "◊ô÷∞◊î◊ï÷∏◊î", sound: "Ado-NAI" },
      { heb: "◊ê÷±◊ú÷π◊î÷µ◊ô◊†◊ï÷º", sound: "e-lo-HEI-nu" },
      { heb: "◊û÷∂◊ú÷∂◊ö÷∞", sound: "ME-lekh" },
      { heb: "◊î÷∏◊¢◊ï÷π◊ú÷∏◊ù", sound: "ha-o-LAM" }
    ]
  },
  {
    name: "Tzitzit (Numbers 15:38-40)",
    hebrewName: "◊¶÷¥◊ô◊¶÷¥◊ô◊™",
    text: "◊ï÷∞◊¢÷∏◊©◊Ç◊ï÷º ◊ú÷∏◊î÷∂◊ù ◊¶÷¥◊ô◊¶÷¥◊™ ◊¢÷∑◊ú ◊õ÷∑÷º◊†÷∞◊§÷µ◊ô ◊ë÷¥◊í÷∞◊ì÷µ◊ô◊î÷∂◊ù ◊ú÷∞◊ì÷π◊®÷π◊™÷∏◊ù ◊ï÷∞◊†÷∏◊™÷∞◊†◊ï÷º ◊¢÷∑◊ú ◊¶÷¥◊ô◊¶÷¥◊™ ◊î÷∑◊õ÷∏÷º◊†÷∏◊£ ◊§÷∞÷º◊™÷¥◊ô◊ú ◊™÷∞÷º◊õ÷µ◊ú÷∂◊™",
    translation: "They shall make for themselves fringes on the corners of their garments throughout their generations, and they shall put on the fringe of each corner a thread of blue.",
    chunks: [
      { heb: "◊ï÷∞◊¢÷∏◊©◊Ç◊ï÷º", sound: "v'a-SU" },
      { heb: "◊ú÷∏◊î÷∂◊ù", sound: "la-HEM" },
      { heb: "◊¶÷¥◊ô◊¶÷¥◊™", sound: "tzi-TZIT" },
      { heb: "◊¢÷∑◊ú", sound: "al" },
      { heb: "◊õ÷∑÷º◊†÷∞◊§÷µ◊ô", sound: "kan-FEI" },
      { heb: "◊ë÷¥◊í÷∞◊ì÷µ◊ô◊î÷∂◊ù", sound: "big-dei-HEM" },
      { heb: "◊ú÷∞◊ì÷π◊®÷π◊™÷∏◊ù", sound: "l'do-ro-TAM" },
      { heb: "◊ï÷∞◊†÷∏◊™÷∞◊†◊ï÷º", sound: "v'nat-NU" },
      { heb: "◊¢÷∑◊ú", sound: "al" },
      { heb: "◊¶÷¥◊ô◊¶÷¥◊™", sound: "tzi-TZIT" },
      { heb: "◊î÷∑◊õ÷∏÷º◊†÷∏◊£", sound: "ha-ka-NAF" },
      { heb: "◊§÷∞÷º◊™÷¥◊ô◊ú", sound: "p'TIL" },
      { heb: "◊™÷∞÷º◊õ÷µ◊ú÷∂◊™", sound: "t'khe-LET" }
    ]
  },
  {
    name: "Aleinu",
    hebrewName: "◊¢÷∏◊ú÷µ◊ô◊†◊ï÷º",
    text: "◊¢÷∏◊ú÷µ◊ô◊†◊ï÷º ◊ú÷∞◊©÷∑◊Å◊ë÷µ÷º◊ó÷∑ ◊ú÷∑◊ê÷≤◊ì◊ï÷π◊ü ◊î÷∑◊õ÷π÷º◊ú",
    translation: "It is our duty to praise the Master of all.",
    chunks: [
      { heb: "◊¢÷∏◊ú÷µ◊ô◊†◊ï÷º", sound: "a-LEI-nu" },
      { heb: "◊ú÷∞◊©÷∑◊Å◊ë÷µ÷º◊ó÷∑", sound: "l'sha-BEI-ach" },
      { heb: "◊ú÷∑◊ê÷≤◊ì◊ï÷π◊ü", sound: "la-a-DON" },
      { heb: "◊î÷∑◊õ÷π÷º◊ú", sound: "ha-KOL" }
    ]
  }
];

// Quiz data
const quizData = words.map(w => ({
  hebrew: w.hebrew,
  answer: w.pronounce,
  wrong: words.filter(x => x !== w).sort(() => Math.random()-0.5).slice(0,3).map(x => x.pronounce)
}));

// ===== STATE =====
let currentWord = 0;
let quizIndex = 0;
let score = 0;
let answered = false;

// ===== BUILD UI =====

function buildWords() {
  const selector = document.getElementById('wordSelector');
  words.forEach((w, i) => {
    const btn = document.createElement('button');
    btn.className = 'word-btn' + (i === 0 ? ' active' : '');
    btn.textContent = w.pronounce;
    btn.onclick = () => selectWord(i);
    selector.appendChild(btn);
  });
  selectWord(0);
}

// Vibrant per-syllable colors
const SYL_COLORS = [
  { bg: '#ff6b6b', text: '#fff' },  // red
  { bg: '#4a90e2', text: '#fff' },  // blue
  { bg: '#f5a623', text: '#fff' },  // orange
  { bg: '#7ed321', text: '#fff' },  // green
  { bg: '#9b59b6', text: '#fff' },  // purple
];

function renderHebrewSpans(w, activeIdx = -1) {
  // Build the big word as colored spans, one per syllable, RTL order
  const hebrewFull = document.getElementById('hebrewFull');
  hebrewFull.innerHTML = w.syllables.map((s, i) => {
    const col = SYL_COLORS[i % SYL_COLORS.length];
    const isActive = i === activeIdx;
    const style = isActive
      ? `color:${col.bg}; text-shadow: 0 0 20px ${col.bg}, 0 4px 16px rgba(0,0,0,0.2); transform:scale(1.15); display:inline-block; transition:all 0.2s;`
      : `color:${col.bg}; opacity:${activeIdx === -1 ? 1 : 0.25}; display:inline-block; transition:all 0.2s;`;
    return `<span class="syl-span" data-idx="${i}" style="${style}">${s.heb}</span>`;
  }).join('<span style="display:inline-block;width:6px;"></span>');
}

function selectWord(i) {
  currentWord = i;
  document.querySelectorAll('.word-btn').forEach((b, idx) => {
    b.classList.toggle('active', idx === i);
  });
  const w = words[i];
  renderHebrewSpans(w, -1);
  document.getElementById('hebrewPronounce').textContent = '(' + w.pronounce + ')';
  document.getElementById('englishMeaning').textContent = w.english;
  document.getElementById('playAllText').textContent = w.pronounce;
  document.getElementById('tipBox').innerHTML = w.tip;

  const row = document.getElementById('syllableRow');
  row.innerHTML = '';
  w.syllables.forEach((s, si) => {
    const col = SYL_COLORS[si % SYL_COLORS.length];
    const block = document.createElement('div');
    block.className = 'syllable-block';
    block.style.borderColor = col.bg;
    block.innerHTML = `<span class="syl-hebrew" style="color:${col.bg}">${s.heb}</span><span class="syl-sound" style="background:${col.bg};color:#fff">${s.sound}</span>`;
    block.onclick = () => {
      renderHebrewSpans(w, si);
      setTimeout(() => renderHebrewSpans(w, -1), 1200);
    };
    row.appendChild(block);
  });
}

async function playAllSyllables() {
  const w = words[currentWord];
  for (let i = 0; i < w.syllables.length; i++) {
    renderHebrewSpans(w, i);
    await new Promise(r => setTimeout(r, 600));
  }
  renderHebrewSpans(w, -1);
}

function buildAlphabet() {
  const grid = document.getElementById('alephBetGrid');
  alphabet.forEach(l => {
    const card = document.createElement('div');
    card.className = 'letter-card';
    card.innerHTML = `<span class="lc-heb">${l.heb}</span><span class="lc-name">${l.name}</span><span class="lc-sound">${l.sound}</span>`;
    card.onclick = () => {
      document.querySelectorAll('.letter-card').forEach(c => c.style.background = '');
      card.style.background = '#1a3a6b';
      card.querySelectorAll('.lc-heb,.lc-name,.lc-sound').forEach(el => el.style.color = 'white');
    };
    grid.appendChild(card);
  });
}

function buildVowels() {
  const grid = document.getElementById('vowelGrid');
  vowels.forEach(v => {
    const card = document.createElement('div');
    card.className = 'vowel-card';
    card.innerHTML = `<span class="vc-heb">${v.heb}</span><span class="vc-name">${v.name}</span><span class="vc-sound">"${v.sound}"</span>`;
    grid.appendChild(card);
  });
}

function buildPrayers() {
  const list = document.getElementById('prayerList');
  prayers.forEach((p, i) => {
    const card = document.createElement('div');
    card.className = 'prayer-card';

    const header = document.createElement('div');
    header.innerHTML = `
      <div class="prayer-name">
        <span>${p.name} <span style="font-size:0.8em;color:#888;">‚ñº</span></span>
        <span class="prayer-hebrew-name">${p.hebrewName}</span>
      </div>
    `;

    const body = document.createElement('div');
    body.className = 'prayer-body hidden';

    const chunksDiv = document.createElement('div');
    chunksDiv.className = 'prayer-syllables';
    chunksDiv.style.cssText = 'direction:rtl; justify-content:flex-start;';

    p.chunks.forEach((c, ci) => {
      const ch = document.createElement('div');
      ch.className = 'chunk';
      ch.style.cursor = 'pointer';
      ch.innerHTML = `<span class="chunk-heb">${c.heb}</span><span class="chunk-sound">${c.sound}</span>`;
      ch.addEventListener('click', e => {
        e.stopPropagation();
        chunksDiv.querySelectorAll('.chunk').forEach(x => x.classList.remove('chunk-active'));
        ch.classList.add('chunk-active');
        setTimeout(() => ch.classList.remove('chunk-active'), 1000);
        speakText(hebrewVoice ? c.heb : c.sound.replace(/'/g,''), hebrewVoice ? 'he-IL' : 'en-US', 0.7);
      });
      chunksDiv.appendChild(ch);
    });

    const pronounceBtn = document.createElement('button');
    pronounceBtn.className = 'pronounce-btn';
    pronounceBtn.style.cssText = 'margin-top:14px;font-size:1em;padding:9px 20px;';
    pronounceBtn.textContent = 'üîä Hear word by word';
    pronounceBtn.addEventListener('click', e => {
      e.stopPropagation();
      pronouncePrayer(pronounceBtn, chunksDiv, p.chunks);
    });

    const intro = document.createElement('div');
    intro.innerHTML = `
      <div class="prayer-text-heb">${p.text}</div>
      <div class="prayer-text-eng">${p.translation}</div>
      <div style="margin-top:12px;font-weight:700;color:#1a3a6b;">Tap any word ‚Äî or hear them all:</div>
    `;
    body.appendChild(intro);
    body.appendChild(chunksDiv);
    body.appendChild(pronounceBtn);

    header.addEventListener('click', () => {
      const isOpen = card.classList.contains('open');
      document.querySelectorAll('.prayer-card').forEach(c => {
        c.classList.remove('open');
        c.querySelector('.prayer-body').classList.add('hidden');
      });
      if (!isOpen) {
        card.classList.add('open');
        body.classList.remove('hidden');
      }
    });

    card.appendChild(header);
    card.appendChild(body);
    list.appendChild(card);
  });
}

function buildQuiz() {
  loadQuestion();
}

function loadQuestion() {
  answered = false;
  document.getElementById('nextBtn').classList.remove('visible');
  document.getElementById('quizFeedback').textContent = '';
  document.getElementById('quizFeedback').className = 'quiz-feedback';

  const shuffled = [...quizData].sort(() => Math.random() - 0.5);
  const q = shuffled[quizIndex % shuffled.length];
  document.getElementById('quizWord').textContent = q.hebrew;
  document.getElementById('qNum').textContent = quizIndex + 1;

  const allAnswers = [q.answer, ...q.wrong].sort(() => Math.random() - 0.5);
  const choicesEl = document.getElementById('quizChoices');
  choicesEl.innerHTML = '';
  allAnswers.forEach(ans => {
    const btn = document.createElement('button');
    btn.className = 'choice-btn';
    btn.textContent = ans;
    btn.onclick = () => handleChoice(btn, ans, q.answer, allAnswers);
    choicesEl.appendChild(btn);
  });
}

function handleChoice(btn, chosen, correct, allAnswers) {
  if (answered) return;
  answered = true;

  const buttons = document.querySelectorAll('.choice-btn');
  if (chosen === correct) {
    btn.classList.add('correct');
    score++;
    document.getElementById('quizFeedback').textContent = 'üéâ Yep! Great job!';
    document.getElementById('quizFeedback').className = 'quiz-feedback correct';
  } else {
    btn.classList.add('wrong');
    buttons.forEach(b => { if (b.textContent === correct) b.classList.add('correct'); });
    document.getElementById('quizFeedback').textContent = '‚ùå Not quite ‚Äî the right answer is highlighted in green!';
    document.getElementById('quizFeedback').className = 'quiz-feedback wrong';
  }

  document.getElementById('scoreDisplay').textContent = score;
  const stars = '‚≠ê'.repeat(Math.min(Math.floor(score/2)+1, 5));
  document.getElementById('scoreStars').textContent = stars;
  document.getElementById('nextBtn').classList.add('visible');
}

function nextQuestion() {
  quizIndex++;
  if (quizIndex >= 10) {
    document.getElementById('quizWord').textContent = 'üéä';
    document.getElementById('quizChoices').innerHTML = `<div style="grid-column:1/-1;text-align:center;font-size:1.3em;font-weight:800;color:#1a3a6b;padding:20px;">You finished! Score: ${score}/10<br>${score >= 8 ? 'üèÜ Amazing!' : score >= 5 ? 'üëç Good work!' : 'üìñ Keep practicing!'}</div>`;
    document.getElementById('quizFeedback').textContent = '';
    document.getElementById('nextBtn').textContent = 'üîÑ Play Again!';
    document.getElementById('nextBtn').classList.add('visible');
    document.getElementById('nextBtn').onclick = () => {
      quizIndex = 0; score = 0;
      document.getElementById('scoreDisplay').textContent = 0;
      document.getElementById('scoreStars').textContent = '‚≠ê';
      document.getElementById('nextBtn').textContent = 'Next ‚û°Ô∏è';
      document.getElementById('nextBtn').onclick = nextQuestion;
      loadQuestion();
    };
    return;
  }
  loadQuestion();
}

// ===== TEXT-TO-SPEECH =====
let hebrewVoice = null;
let ttsReady = false;

function initTTS() {
  if (!window.speechSynthesis) {
    document.getElementById('ttsNote').textContent = '‚ö†Ô∏è Your browser doesn\'t support speech. Try Chrome.';
    return;
  }
  function loadVoices() {
    const voices = speechSynthesis.getVoices();
    // Look for Hebrew voice
    hebrewVoice = voices.find(v => v.lang.startsWith('he')) || null;
    ttsReady = true;
    const note = document.getElementById('ttsNote');
    if (hebrewVoice) {
      note.textContent = '‚úÖ Hebrew voice found: ' + hebrewVoice.name;
      note.style.color = '#2ecc71';
    } else {
      note.textContent = '‚ö†Ô∏è No Hebrew voice found ‚Äî using English approximation. Install Hebrew on your device for best results!';
      note.style.color = '#e67e22';
    }
  }
  if (speechSynthesis.getVoices().length) loadVoices();
  else speechSynthesis.addEventListener('voiceschanged', loadVoices);
}

async function speakUtterance(utter) {
  return new Promise((resolve, reject) => {
    utter.onend = resolve;
    utter.onerror = reject;
    speechSynthesis.speak(utter);
  });
}

async function pronounceWord() {
  if (!window.speechSynthesis) return;
  const w = words[currentWord];
  const btn = document.getElementById('pronounceBtn');

  // Fix Chrome stuck bug
  speechSynthesis.cancel();
  await new Promise(r => setTimeout(r, 150));
  speechSynthesis.resume();

  btn.classList.add('speaking');
  btn.textContent = 'üîä Speaking...';

  // Speak each syllable ‚Äî animate its color in the big display box
  for (let i = 0; i < w.syllables.length; i++) {
    const syl = w.syllables[i];
    renderHebrewSpans(w, i);  // dim others, glow this one

    const utter = new SpeechSynthesisUtterance();
    if (hebrewVoice) {
      utter.voice = hebrewVoice;
      utter.lang = 'he-IL';
      utter.text = syl.heb;
    } else {
      utter.lang = 'en-US';
      utter.text = syl.sound.replace(/'/g, '');
      utter.rate = 0.65;
    }
    utter.rate = hebrewVoice ? 0.75 : 0.65;

    try { await speakUtterance(utter); } catch(e) { break; }
    await new Promise(r => setTimeout(r, 220));
  }

  // All fully lit at end
  renderHebrewSpans(w, -1);

  btn.classList.remove('speaking');
  btn.textContent = 'üîä Hear it spoken';
}


// ===== PRAYER PRONUNCIATION =====
function speakText(text, lang, rate) {
  speechSynthesis.cancel();
  setTimeout(() => {
    speechSynthesis.resume();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = lang;
    u.rate = rate || 0.75;
    if (lang === 'he-IL' && hebrewVoice) u.voice = hebrewVoice;
    speechSynthesis.speak(u);
  }, 120);
}

async function pronouncePrayer(btn, chunksDiv, chunks) {
  btn.classList.add('speaking');
  btn.textContent = 'üîä Speaking...';

  speechSynthesis.cancel();
  await new Promise(r => setTimeout(r, 150));
  speechSynthesis.resume();

  const chunkEls = chunksDiv.querySelectorAll('.chunk');

  for (let i = 0; i < chunks.length; i++) {
    const c = chunks[i];
    chunkEls.forEach(x => x.classList.remove('chunk-active'));
    if (chunkEls[i]) chunkEls[i].classList.add('chunk-active');

    const u = new SpeechSynthesisUtterance();
    if (hebrewVoice) {
      u.voice = hebrewVoice;
      u.lang = 'he-IL';
      u.text = c.heb;
    } else {
      u.lang = 'en-US';
      u.text = c.sound.replace(/'/g, '');
      u.rate = 0.65;
    }
    u.rate = hebrewVoice ? 0.75 : 0.65;

    try { await speakUtterance(u); } catch(e) { break; }
    await new Promise(r => setTimeout(r, 250));
  }

  chunkEls.forEach(x => x.classList.remove('chunk-active'));
  btn.classList.remove('speaking');
  btn.textContent = 'üîä Hear word by word';
}

function showTab(tab, clickedBtn) {
  ['words','alphabet','vowels','prayers','quiz'].forEach(t => {
    document.getElementById('tab-' + t).classList.add('hidden');
  });
  document.getElementById('tab-' + tab).classList.remove('hidden');
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  if (clickedBtn) clickedBtn.classList.add('active');
}

// ===== INIT =====
buildWords();
buildAlphabet();
buildVowels();
buildPrayers();
buildQuiz();
initTTS();
</script>
</body>
</html>
